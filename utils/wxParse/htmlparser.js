function HTMLParser(e,t){function a(e,n,r,i){n=n.toLowerCase();if(block[n])while(s.last()&&inline[s.last()])f("",s.last());closeSelf[n]&&s.last()==n&&f("",n),i=empty[n]||!!i,i||s.push(n);if(t.start){var o=[];r.replace(attr,function(e,t){var n=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:fillAttrs[t]?t:"";o.push({name:t,value:n,escaped:n.replace(/(^|[^\\])"/g,'$1\\"')})}),t.start&&t.start(n,o,i)}}function f(e,n){if(!n)var r=0;else{n=n.toLowerCase();for(var r=s.length-1;r>=0;r--)if(s[r]==n)break}if(r>=0){for(var i=s.length-1;i>=r;i--)t.end&&t.end(s[i]);s.length=r}}var n,r,i,s=[],o=e;s.last=function(){return this[this.length-1]};while(e){r=!0;if(!s.last()||!special[s.last()]){e.indexOf("<!--")==0?(n=e.indexOf("-->"),n>=0&&(t.comment&&t.comment(e.substring(4,n)),e=e.substring(n+3),r=!1)):e.indexOf("</")==0?(i=e.match(endTag),i&&(e=e.substring(i[0].length),i[0].replace(endTag,f),r=!1)):e.indexOf("<")==0&&(i=e.match(startTag),i&&(e=e.substring(i[0].length),i[0].replace(startTag,a),r=!1));if(r){n=e.indexOf("<");var u="";while(n===0)u+="<",e=e.substring(1),n=e.indexOf("<");u+=n<0?e:e.substring(0,n),e=n<0?"":e.substring(n),t.chars&&t.chars(u)}}else e=e.replace(new RegExp("([\\s\\S]*?)</"+s.last()+"[^>]*>"),function(e,n){return n=n.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2"),t.chars&&t.chars(n),""}),f("",s.last());if(e==o)throw"Parse Error: "+e;o=e}f()}function makeMap(e){var t={},n=e.split(",");for(var r=0;r<n.length;r++)t[n[r]]=!0;return t}var startTag=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag=/^<\/([-A-Za-z0-9_]+)[^>]*>/,attr=/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,empty=makeMap("area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr"),block=makeMap("a,address,code,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video"),inline=makeMap("abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),closeSelf=makeMap("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),fillAttrs=makeMap("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),special=makeMap("wxxxcode-style,script,style,view,scroll-view,block");module.exports=HTMLParser;